@{
    ActionDescriptor action = ViewBag.ActionInfo;
    AiBi.Test.Dal.Model.SysUser CurrentUser = ViewBag.CurrentUser;
    Dictionary<string, object> PageInfo = ViewBag.PageInfo;
}
<!doctype html>
<!--
* Tabler - Premium and Open Source dashboard template with responsive and high quality UI.
* @@version 1.0.0-beta20
* @@link https://tabler.io
* Copyright 2018-2023 The Tabler Authors
* Copyright 2018-2023 codecalm.net Paweł Kuna
* Licensed under MIT (https://github.com/tabler/tabler/blob/master/LICENSE)
-->
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>@ViewBag.Title - @MvcApplication.Title</title>
    <!-- CSS files -->
    @RenderSection("stylesbefore", false)
    <link href="~/layui/css/layui.css?@MvcApplication.Version" rel="stylesheet" />
    <link href="~/Styles/aibibase.css?@MvcApplication.Version" rel="stylesheet" />
    <script>
        window.CurrentUser = @JsonHelper.ToJson(CurrentUser);
        window.BaseUrl = '/@action.ControllerDescriptor.ControllerName';
        window.Title = "@ViewBag.Title";
        window.PageInfo = @JsonHelper.ToJson(ViewBag.PageInfo);
        window.TimeInfo = {
            Server: new Date('@(DateTime.Now.ToString("yyyy/MM/dd HH:mm:ss.fff"))'),
            Client: new Date()
        };
        window.ActionInfo = {
            Action: "@action.ActionName",
            Controller: "@action.ControllerDescriptor.ControllerName",
        };
    </script>
    @RenderSection("styles", false)
</head>
<body>
    @RenderBody()
    <script src="~/Scripts/jquery-3.4.1.min.js?@MvcApplication.Version"></script>
    <script src="~/Scripts/jquery.validate.min.js?@MvcApplication.Version"></script>
    <script src="~/layui/layui.js?@MvcApplication.Version"></script>
    <script src="~/Scripts/aibibase.js?@MvcApplication.Version"></script>
    <script>
        (function ($$) {
            let obj = $$;
            $.extend($$, {
                tabName: function () {
                    let dataid = top.$(window.frameElement).attr("data-id");
                    return top.$("i[data-id=" + dataid + "]").prev("cite").text();
                },
                closeThis: function () {
                    if (!top.tab || !top.tab.closeTab) {
                        window.close();
                        return;
                    }
                    var iframe = window.frameElement;
                    if (!iframe) return;
                    if (!$(iframe).attr("data-id")) return;
                    top.tab.closeTab($(iframe).attr("data-id"));
                },
                addTab: function (name, url) {
                    url = obj.toOpenUrl(url, name);
                    if (top === window && typeof window.addTab !== "function") {
                        var winhwnd = window.open("about:blank");
                        winhwnd.location.href = url;
                        return;
                    }
                    top.addTab(name, url);
                },
                opener: function () {
                    if (window.opener) {
                        return window.opener;
                    }

                    if (!PageInfo || !PageInfo.opener || !top.findTab) {
                        return top !== window ? top : null;
                    }
                    let tmptab = top.findTab(PageInfo.opener);
                    if (!tmptab) {
                        return null;
                    }
                    return tmptab.page.find("iframe")[0].contentWindow;
                },
            });
        })($$);
    </script>
    @RenderSection("scripts", false)
    @if (!(ViewBag.NoScript ?? false))
    {
        <script src="~/Scripts/@(action.ControllerDescriptor.ControllerName.ToLower())/@((string.IsNullOrEmpty(PageInfo.G<string>("View")) ?action.ActionName:PageInfo.G<string>("View")).ToLower()).js?@MvcApplication.Version"></script>
    }
</body>
</html>